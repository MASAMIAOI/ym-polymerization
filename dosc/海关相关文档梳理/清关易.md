# 清关易大致流程

作者: 申锐岩\
日期: 2023.04.18 \
版本: 1.0


| 版本号 | 章节 | 内容 | 日期       | 修改人 |
|--------|------|------|------------|--------|
| 1.0    |      |      | 2023.04.18 | 申锐岩    |
				 

[TOC]


---
## 1. 目的

> 必选
固定话述，强调写此文档的意义。
描述功能如何实现，指导开发人员完成开发，可作为了解功能实现的主要依据。


* 了解相关过关的一些基本流程

## 2. 名词解释

> 非必选\
系统、功能、需求、技术等专有名词的释义。\
形式：文字描述

过关主体
* 人
* 车
* 货
* 货车一体


提交方式：
* 电子
* 纸禀
* 自动清关

类型：
* 陆运
* 航空
* 海运

清关方式
* 手动绑定
* 快速绑定

过关流程
* 电子、纸柄 ：车闸 -> 货场 -> 入境
* 自动清关： 来源于电子，电子审查之后再导自动清关

`GDC`： 海关系统

`EDI`： 海关数据库


EDI 预评估： 10 min / 1
数据同步风管： 5 min / 1



> 评估元素：
监察名单
电脑算法
人工干预
个性化规则




## 3. 时序图

> 非必选\
如果可以用开发规范约定，就不需要画图。\
复杂的程序调用、运行顺序，需要花图。\
形式：时序图，代码（写框架代码）

### 3.1  纸禀流程
```plantuml

' 语法教程: https://plantuml.com/zh/sequence-diagram

title  纸禀 流程
hide footbox

actor "车" as car

participant "货场" as  hc

box 发起方
participant "业务人员" as ry_yw
participant "经科局" as  ry_jkj
participant "EDI(海关数据库)" as EDI
participant "统计局" as  ry_tjj
participant "风险管理局" as  ry_fxgl
end box

box 检查过程
participant "车闸1" as  jcgc_cz1
end box

participant "清关结束" as qgjs

autonumber

car -> ry_yw: 上报相关货物， 填写申报单
ry_yw -> ry_jkj: 发送申报单给经科局
car -> jcgc_cz1: 车辆开始过关
jcgc_cz1 -> hc: 货场进行检查
hc -> qgjs: 清关结束
qgjs -> ry_tjj: 数据录入到统计局中

```

> 问题
*  纸禀流程根据代码再次确认一下

> 统计局数据转入到风险管理局
```plantuml

' 语法教程: https://plantuml.com/zh/sequence-diagram

title  数据接入
hide footbox

box 发起方
participant "统计局" as  ry_tjj
participant "风险管理局" as  ry_fxgl
autonumber

ry_tjj -> ry_fxgl: mongodb 文件同步至风险管理局 （10 min / 次）

activate ry_fxgl

ry_fxgl -> ry_fxgl: 清洗 mongodb 文件内容，写入到相关表中

deactivate ry_fxgl

```

> 问题
*  mongodb 文件同步 ， 10 min / 次 的频率， 是没 10 min 给一次文件么

### 3.2 电子流程

```plantuml

' 语法教程: https://plantuml.com/zh/sequence-diagram

title 电子流程
hide footbox 

actor "车" as car
participant "货场" as  hc

box 发起方
participant "业务人员" as ry_yw
participant "经科局" as  ry_jkj
participant "EDI(海关数据库)" as EDI
control "定时调度" as  timer
participant "风险管理局" as  ry_fxgl
end box



box 检查过程
participant "车闸1" as  jcgc_cz1
participant "人工" as  jcgc_rg
end box

participant "清关结束" as qgjs


autonumber


car -> ry_yw: 上报相关货物， 填写申报单

ry_yw -> ry_jkj: 发送申报单给经科局

ry_jkj -> EDI: 数据录入到海关数据库中

timer -> ry_fxgl: run
note left: 经科局数据同步至风险管理局

alt 预评估
ry_fxgl -> ry_fxgl: 风险预评估 (5min / 次)
end 

ry_fxgl -> jcgc_cz1: 车辆开始过关
jcgc_cz1 -> ry_fxgl: 访问风管进行第一次检查


activate hc
alt 进行相关检查内容
ry_fxgl -> ry_fxgl: 相关检查
    note left
    监察名单，电脑算法，个性化规则
    end note
else
ry_fxgl -> hc: 检查未通过货场重新检查
end
deactivate hc

ry_fxgl -> jcgc_rg: 检查通过,告知结果给人工

alt 进行人工干预
jcgc_rg -> hc: 货场检查
end

jcgc_rg -> ry_fxgl: 检查通过，将结果同步给风险管理平台

jcgc_rg -> qgjs: 清关结束

```

### 3.3 自动清单流程


